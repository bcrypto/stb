# 5 Общие положения

## 5.1 Назначение

Настоящий стандарт устанавливает форматы РЭЦП, а также правила выработки, 
дополнения и проверки расширенных подписей. Стандарт основан на документах 
[XADES1-PROCESSES], разработанных Европейским институтом 
телекоммуникационных стандартов (ETSI).

Расширенная подпись дополнительно к базовой (вырабатываемой, например, с
помощью алгоритмов СТБ 34.101.45) включает атрибуты подписанного документа
и подписавшей его стороны. Подпись встраивается в документ (вложенная
подпись), включает документ (обертывающая подпись) или хранится отдельно от
него (отделенная подпись). Подпись делает документ электронным, т.е.
защищенным. Проверяя подпись, можно удостовериться в целостности и
подлинности ЭД. Атрибуты усиливают гарантии целостности и подлинности,
уточняют правила проверки подписи, облегчают проверку.

Атрибуты могут быть подписанными и неподписанными. РЭЦП контролирует
целостность и подлинность подписанных атрибутов. Фактически сам документ
представляется такими атрибутами - идентификатором алгоритма хэширования и
хэш-значением, полученным с помощью этого алгоритма. Примеры других
подписанных атрибутов - тип документа, время подписи, сертификат
подписанта. Неподписанные атрибуты - это, как правило, аттестаты, которые
используются при проверке подписи. Примеры неподписанных атрибутов -
цепочка сертификатов, список отозванных сертификатов, ссылка на цепочку или
список, штамп времени.

В разделе 6 определяются возможные атрибуты РЭЦП: описывается их семантика
(содержание, интерпретация), дается классификация (подписанный,
неподписанный).

В зависимости от ситуации, т.е. нужд конкретной информационной системы,
в РЭЦП могут включаться те или иные атрибуты. Перечень обязательных и 
рекомендуемых атрибутов, правила их формирования и разбора описываются 
профилями атрибутов. В разделе 7 определяются 4 таких профиля. 
Профили обозначаются аббревиатурами B-B, B-T, B-LT, B-LTA.
Профили в указанном порядке последовательно расширяют друг друга. 

Профиль B-B (базовый) требует включения в РЭЦП стандартных базовых
атрибутов. Профиль B-T (контроль времени подписи) дополнительно требует
включения штампа времени. Профиль B-LT (долгосрочный) обязывает добавлять в
РЭЦП все сертификаты, задействованные прямо или косвенно, вместе с
информацией об их текущем статусе. Профиль B-LTA (долгосрочный архивный)
требует включения штампа времени от всех атрибутов профиля B-LT. Штамп
подтверждает корректность всех предъявленных (в момент постановки штампа)
аттестатов. Вырабатывая штампы периодически (например, ежегодно) и
используя при этом сохранившие стойкость криптографические алгоритмы, можно
обеспечить надежное архивное хранение ЭД даже при снижении стойкости
первоначальных алгоритмов.

Кроме 4 перечисленных профилей, которые считаются базовыми, в приложении A
определяются 8 расширенных: E-BES, E-EPES, E-T, E-C, E-A, E-X, E-X-L,
E-X-Long. В расширенных профилях, в отличие от базовых, разрешается не
указывать сертификаты, списки отозванных сертификатов и другие аттестаты, 
а давать ссылки на них. 

В разделе 8 определяются процессы выработки и проверки РЭЦП базовых
профилей, и при этом описываются процессы дополнения РЭЦП новыми
неподписанными атрибутами. Процессы дополнения встроены в процессы
выработки подписи, их выполняет подписант. Процессы дополнения имеют также
самостоятельное значение, их может выполнять верификатор.

## 5.2 Форматы

Формат РЭЦП определяет ее синтаксис, т.е. правила записи и кодирования
атрибутов и базовой ЭЦП. Формат может также определять правила встраивания
РЭЦП в ЭД. В настоящем стандарте определены три формата: CAdES, XAdES и
PAdES.

Формат CAdES (от англ. CMS Advanced Electronic Signature) является
уточнением формата подписанных данных, определенного в СТБ 34.101.23
(раздел 8). Подпись CAdES описывается на языке АСН.1, определенном 
в ГОСТ 34.973, и задается типом `SignedData`. Подписываемый документ
может иметь произвольный формат.

Формат XAdES (от англ. XML Advanced Electronic Signature) является
уточнением формата XML-DSig, представленного в СТБ 34.101.50 (приложение E).
Подпись XAdES описывается на языке XML, определенном в [XML]. Подписываются
части (элементы) XML-документа или весь XML-документ целиком.

Подпись PAdES (от англ. PDF Advanced Electronic Signature) встраивается в
документы формата PDF, определенного в [PDF]. Подпись представляется либо в
формате CAdES, либо в формате XAdES.

Каждый из форматов уточняется профилем атрибутов. Профиль добавляется к 
названию формата через дефис. Например, через CAdES-B-LTA обозначается 
долгосрочная архивная РЭЦП формата CAdES.

<!--
todo: CAdES-B-LTA вместо "профиль B-LTA формата Cades"

todo: при описании спец атрибутов -- сначала атрибуты Cades, затем Xades

todo: Countersignature vs CounterSignature
--->

## 5.3 Стороны

В создании и проверке РЭЦП участвуют следующие стороны:

- подписант;
- верификатор;
- поставщики услуг доверия.

Подписант вырабатывает РЭЦП документа. Выработка подписи 
означает взятие на себя ответственности за содержимое документа. 

Верификатор проверяет РЭЦП. Одну и ту же РЭЦП могут проверять несколько
верификаторов.

Поставщики услуг доверия создают доверенные отношения между подписантом и
верификатором, выпуская сертификаты, штампы времени, СОС, ответы OCSP и др.
данные. Эти данные могут использоваться в качестве аттестатов.

В настоящем стандарте рассматриваются следующие поставщики услуг доверия: 

- удостоверяющие центры;
- издатели СОС;
- регистрационные центры;
- серверы OCSP;
- службы хранения;
- службы штампов времени;
- службы рапортов времени;
- издатели политик подписи.

УЦ выпускают СОК, оказывают владельцам услуги по их отзыву, информируют
других пользователей об отзыве, выпуская СОС. УЦ может делегировать функцию
выпуска СОС отдельной службе. Логика работы УЦ, форматы СОК и СОС
определены в СТБ 34.101.19.

РЦ проверяют подлинность пользователей перед тем, как УЦ выдаст им
сертификат.

Серверы OCSP обрабатывают запросы о статусе сертификатов и выпускают
соответствующие ответы. Логика работы серверов, форматы запросов и ответов
определены в СТБ 34.101.26.

Службы хранения публикуют СОK и СОС, выпущенные УЦ, политики подписей,
выпущенные издателями политик, другие данные.

Службы штампов (рапортов) времени удостоверяют (регистрируют) существование
определенных данных к определенному моменту времени.

Наконец, издатели политик подписи определяют правила, которые
обеспечивают согласованность результатов проверки подписи различными
верификаторами. Подписант либо явно задает используемую политику
(например, через атрибут), либо политика неявно определяется по
подписанным данным. Политика определяется достаточно подробно, чтобы
результаты проверки подписи различными верификаторами не отличались.

Дополнительно в качестве поставщиков услуг доверия могут использоваться
центры атрибутных сертификатов. Эти центры фиксируют полномочия владельцев
СОК, выпуская для них атрибутные сертификаты.

