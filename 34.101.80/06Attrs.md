# 6 <a name="Attr"></a>Атрибуты

<!--- при описании атрибутов в комментариях даются ссылки на разделы 
в первоисточниках: ETSI TS 101 733 v020202; ETSI TS 119 122 01 v010001
-->

## 6.1 <a name="Attr1"></a>Общие положения

Атрибуты содержат информацию, которая уточняет интерпретацию и назначение РЭЦП.
Атрибуты формируются подписантом или системой выработки РЭЦП в соответствии с
политикой подписи и выбранным профилем РЭЦП.

Атрибуты МОГУТ быть подписанными или неподписанными. Подписанные атрибуты
фиксируются при выработке ЭЦП. Неподписанные атрибуты могут быть добавлены или
удалены позже; целостность и подлинность таких атрибутов контролируется неявно.
Набор атрибутов, включаемых в РЭЦП, определяется политикой РЭЦП.

Атрибут МОЖЕТ не включаться в РЭЦП, включаться в единственном экземпляре или
включаться несколько раз.

Формат подписанных данных МОЖЕТ содержать несколько подписей, выработанных
различными подписантами (утверждающая подпись включается как неподписанный
атрибут утверждаемой подписи, а не отдельная, независимая подпись). Атрибуты
формируются подписантами независимо. Подписи, сформированные различными
подписантами, МОГУТ соответствовать различным профилям.

Семантика и правила включения атрибутов МОГУТ отличаться в зависимости от
формата. В этом случае при описании атрибута указывается явно, в РЭЦП какого
формата он применяется.

Атрибуты можно разбить на 4 класса:

- базовые атрибуты, относящиеся к подписанту, подписываемым данным или подписи;
- атрибуты, содержащие штамп времени подписи; 
- атрибуты, содержащие проверочные данные;
- атрибуты, содержащие данные для архивной проверки.

РЭЦП МОЖЕТ содержать другие атрибуты, специфичные для приложения.

## 6.2 <a name="Attr2"></a>Базовые атрибуты РЭЦП

### 6.2.1 <a name="Attr21"></a>Атрибут `ContentType`
<!--- 5.7.1; 5.1.1 -->

Подписанный атрибут `ContentType` определяет тип подписанного документа.
Включается в единственном экземпляре. Данный атрибут применяется в РЭЦП формата
CAdES.

### 6.2.2 <a name="Attr22"></a>Атрибут `MessageDigest`
<!--- 5.7.2; 5.1.2 -->

Подписанный атрибут `MessageDigest` определяет хэш-значение подписанного
документа. Включается в единственном экземпляре. Данный атрибут применяется в
РЭЦП формата CAdES.

### 6.2.3 <a name="Attr23"></a>Атрибут `SigningTime`
<!--- 5.9.1; 5.2.1 -->

Подписанный атрибут `SigningTime` определяет время выработки ЭЦП по утверждению
подписанта. Включается в единственном экземпляре.

### 6.2.4 <a name="Attr24"></a>Атрибут `SigningCertificate`
<!--- 5.7.3; 5.2.2 -->

Подписанный атрибут `SigningCertificate` определяет список ссылок на
сертификаты, используемые при проверке подписи. Включается в единственном
экземпляре.

Список ссылок ДОЛЖЕН быть непустым, первая ссылка в списке ДОЛЖНА указывать на
сертификат подписанта. Атрибут предназначен для предотвращения простых атак с
подменой и повторной выдачей сертификата, а также ограничивает набор
сертификатов для проверки подписи. Без этого атрибута подмена недействительного
сертификата подписанта на действительный, выпущенный для того же открытого
ключа, не будет обнаружена. Ссылка однозначно идентифицирует сертификат по
хэш-значению. Хэшируется сертификат, закодированный по отличительным правилам.
Алгоритм хэширования либо подразумевается неявно, либо явно указывается в
ссылке. Для поиска сертификата может использоваться необязательный компонент,
содержащий имя издателя и серийный номер. При несовпадении указанного и
вычисленного хэш-значений, подпись ДОЛЖНА считаться недействительной.

>Примечание — Если атрибутный сертификат используется подписантом для связи его
роли или других атрибутов с подписью, то данные сведения указываются в атрибуте
`SignerAttributes`.

### 6.2.5 <a name="Attr25"></a>Атрибут `CommitmentTypeIndication`
<!--- 5.11.1; 5.2.3 -->

Подписанный атрибут `CommitmentTypeIndication` определяет обязательства
подписанта перед проверяющей стороной. Включается в единственном экземпляре.

Тип обязательства может быть определен как часть политики подписи или быть
зарегистрированным определенной службой регистрации, например, торговой
ассоциацией или законодательным органом. В обоих случаях тип обязательства
должен обладает точной семантикой.

Политика подписи определяет набор атрибутов, которые она поддерживает.
Поддерживаемый набор атрибутов включает все типы обязательств, определенных в
политике подписи, а также все внешне заданные типы обязательств, которые
политика может распознавать.

В настоящем стандарте определены следующие общие типы обязательств:

- доказательство происхождения (proof of origin) указывает, что подписант
признает создание, утверждение и отправку сообщения;
- доказательство получения (proof of receipt) указывает, что подписант признает
получение содержимого сообщения;
- доказательство доставки (proof of delivery) указывает, что поставщик услуг
доверия, предоставляющий эту информацию, доставил сообщение в локальное
хранилище, доступное получателю сообщения;
- доказательство отправителя (proof of sender) указывает, что сторона,
предоставляющая эту информацию, отправила сообщение (но необязательно создала
его);
- доказательство утверждения (proof of approval) указывает, что подписант
утвердил содержимое сообщения;
- доказательство создания (proof of creation) указывает, что подписант создал
содержимое сообщения (но необязательно утвердил или отправил его).

### 6.2.6 <a name="Attr26"></a>Атрибут `ContentHints`
<!--- 5.10.3; 5.2.4.1 -->

Подписанный атрибут `ContentHints` содержит сведения о наиболее глубоко
вложенном подписанном содержимом многоуровневого документа, в котором одно
содержимое вложено в другое.

Данный атрибут применяется в РЭЦП формата CAdES и НЕ МОЖЕТ быть атрибутом
удостоверяющей подписи.

### 6.2.7 <a name="Attr27"></a>Атрибут `MimeType`
<!--- ; 5.2.4.2 -->

Подписанный атрибут `MimeType` содержит MIME-тип подписываемого содержимого. 

Данный атрибут применяется в РЭЦП формата CAdES и НЕ МОЖЕТ быть атрибутом
удостоверяющей подписи.

### 6.2.8 <a name="Attr28"></a>Атрибут `DataObjectFormat`
<!--- ; 5.2.4 XAdES -->

Подписанный атрибут `DataObjectFormat` содержит информацию о формате
подписываемого содержимого, такую как описание и идентификатор содержимого,
MIME-тип, метод кодирования.

Данный атрибут применяется в РЭЦП формата XAdES.

### 6.2.9 <a name="Attr29"></a>Атрибут `SignerLocation`
<!--- 5.11.2; 5.2.5 -->

Подписанный атрибут `SignerLocation` содержит географический адрес подписанта.
Включается в единственном экземпляре.

### 6.2.10 <a name="Attr210"></a>Атрибут `SignerAttributes`
<!--- 5.11.3; 5.2.6.1 -->

Подписанный атрибут `SignerAttributes` содержит дополнительные атрибуты
подписанта (например, роль). Включается в единственном экземпляре. Этот атрибут
МОЖЕТ включать:

- запрашиваемые подписантом атрибуты, в том числе SAML-утверждения, не
подписанные (не удостоверенные) центром атрибутных сертификатов;
- атрибутные сертификаты — атрибуты подписанта, подписанные (удостоверенные)
центром атрибутных сертификатов;
- утверждения, подписанные третьей стороной.

### 6.2.11 <a name="Attr211"></a>Атрибут `Countersignature`
<!--- 5.9.2; 5.2.7 -->

Неподписанный атрибут `Countersignature` содержит удостоверяющую подпись. РЭЦП
МОЖЕТ содержать несколько экземпляров данного атрибута. Удостоверяющая подпись
обычно представляет собой РЭЦП, в которой в качестве подписываемых данных
выступает удостоверяемая РЭЦП.

### 6.2.12 <a name="Attr212"></a>Атрибут `ContentTimeStamp`
<!--- 5.11.4; 5.2.8 -->

Подписанный атрибут `ContentTimeStamp` содержит штамп времени содержимого
подписываемых данных до их подписания. РЭЦП МОЖЕТ содержать несколько
экземпляров данного атрибута. Данный атрибут применяется в РЭЦП формата CAdES.

### 6.2.13 <a name="Attr213"></a>Атрибут `AllDataObjectsTimeStamp`
<!--- ; 5.2.8.1 XAdES -->

Подписанный атрибут `AllDataObjectsTimeStamp` содержит штамп времени
конкатенации всех объектов данных после форматирования. Данный атрибут
применяется в РЭЦП формата XAdES.

### 6.2.14 <a name="Attr214"></a>Атрибут `IndividualDataObjectsTimeStamp`
<!--- ; 5.2.8.2 XAdES -->

Подписанный атрибут `IndividualDataObjectsTimeStamp` содержит штамп времени
конкатенации некоторых объектов данных после форматирования. Данный атрибут
применяется в РЭЦП формата XAdES.

### 6.2.15 <a name="Attr215"></a>Атрибут `SignaturePolicyIdentifier`
<!--- 5.8.1; 5.2.9 -->

Подписанный атрибут `SignaturePolicyIdentifier` содержит либо явный
идентификатор политики подписи, либо указание о наличии неявной политики
подписи. Указание о наличии неявной политики используется только в формате
XAdES. Включается в единственном экземпляре.

### 6.2.16 <a name="Attr216"></a>Атрибут `SignaturePolicyStore`
<!--- ; 5.2.10 -->

Неподписанный атрибут `SignaturePolicyStore` содержит документ, содержащий
политику подписи, идентификатор которого указан в атрибуте
`SignaturePolicyIdentifier`, либо URI, указывающий на локальное хранилище,
содержащее документ с политикой подписи. Включается в единственном экземпляре.

### 6.2.17 <a name="Attr217"></a>Атрибут `ContentReference`
<!--- 5.10.1; 5.2.11 -->

Подписанный атрибут `ContentReference` содержит ссылку на другую РЭЦП. Ссылка
может использоваться для связи документа-ответа с документом-запросом.
Включается в единственном экземпляре. Данный атрибут применяется в РЭЦП формата
CAdES.

### 6.2.18 <a name="Attr218"></a>Атрибут `ContentIdentifier`
<!--- 5.10.2; 5.2.12 -->

Подписанный атрибут `ContentIdentifier` содержит идентификатор подписанного
содержимого, используемый в качестве метки при ссылке на текущую подпись,
например, в атрибуте `ContentReference`. Включается в единственном экземпляре.
Данный атрибут применяется в РЭЦП формата CAdES.

## 6.3 <a name="Attr3"></a>Атрибут штампа времени подписи

### 6.3.1 <a name="Attr31"></a>Атрибут `SignatureTimeStamp`
<!--- 6.1; 5.3 -->

Неподписанный атрибут `SignatureTimeStamp` содержит штамп времени, вычисленный
от значения подписи. РЭЦП МОЖЕТ содержать несколько экземпляров данного
атрибута.

Штампы времени ДОЛЖНЫ выставляться до истечения срока действия или отзыва
сертификата подписанта.

## 6.4 <a name="Attr4"></a>Атрибуты для указания проверочных данных

<!--- Атрибуты проверки цепочки сертификатов-->

### 6.4.1 <a name="Attr41"></a>Атрибут `CompleteCertificateReferences`
<!--- 6.2.1; A.1.1.1 -->

Неподписанный атрибут `CompleteCertificateReferences` содержит набор ссылок на
сертификаты, используемые для проверки подписи:

а) ДОЛЖЕН содержать ссылки на сертификаты цепочки, включая сертификат точки
доверия, промежуточных УЦ и не включая сертификат подписанта.

б) МОЖЕТ содержать ссылки на сертификаты цепочек от точки доверия до конечных
сертификатов, использованных для подписи списков отзыва и OCSP-ответов,
используемых для проверки статуса сертификатов, ссылки на которые указаны в
списке 1.

в) НЕ ДОЛЖЕН включать ссылки на сертификаты, входящие только в цепочки проверки
атрибутных сертификатов или подписанных утверждений.

>Примечание 1 — Ссылка на сертификат подписанта указывается в атрибуте
`SigningCertificate`.

>Примечание 2 — Ссылки на сертификаты, входящие только в цепочки проверки
атрибутных сертификатов или подписанных утверждений, указываются в атрибуте
`AttributeCertificateReferences`.

### 6.4.2 <a name="Attr42"></a>Атрибут `CertificateValues`
<!--- 6.3.3; A.1.1.2 -->

Неподписанный атрибут `CertificateValues` содержит сертификаты из перечня,
определенного при описании атрибута `CompleteCertificateReferences`. В список
`CertificateValues` включаются сертификаты, не входящие в стандартные списки
CAdES (компонент `SignedData.certificates`)  или XAdES (внутри элемента
`ds:KeyInfo`). В РЭЦП формата CAdES атрибут `CertificateValues` может также
содержать сертификаты, ссылки на которые указаны в атрибутах
`AttributeCertificateReferences` и `SigningCertificate`.

<!--- Атрибуты проверки отзыва сертификатов-->

### 6.4.3 <a name="Attr43"></a>Атрибут `CompleteRevocationReferences`
<!--- 6.2.2; A.1.2.1 -->

Неподписанный атрибут `CompleteRevocationReferences` содержит набор ссылок на
аттестаты отзыва (списки отзыва, OCSP-ответы):

а) ДОЛЖЕН содержать ссылки на аттестаты отзыва сертификатов, ссылки на которые
указаны в атрибуте `CompleteCertificateReferences`, не включая сертификаты точек
доверия и включая сертификат подписанта.

б) МОЖЕТ содержать ссылки на аттестаты отзыва сертификатов, используемых для
подписи элементов отзыва, ссылки на которые указаны в списке 1.

в) НЕ ДОЛЖЕН включать ссылки на аттестаты отзыва сертификатов, входящих только в
цепочки проверки атрибутных сертификатов или подписанных утверждений.

>Примечание 1 — Информация об отзыве сертификатов точек доверия не указывается,
т.к. доверие к ним безусловное.

>Примечание 2 — Ссылки на аттестаты отзыва сертификатов, входящих только в
цепочки проверки атрибутных сертификатов или подписанных утверждений,
указываются в атрибуте `AttributeRevocationReferences`.

### 6.4.4 <a name="Attr44"></a>Атрибут `RevocationValues`
<!--- 6.3.4; A.1.2.2 -->

Неподписанный атрибут `RevocationValues` содержит аттестаты отзыва из перечня,
определенного при описании атрибута `CompleteRevocationReferences`. В список
`RevocationValues` включаются аттестаты отзыва, не входящие в стандартные списки
CAdES (компонент `SignedData.crls`) или XAdES (внутри элемента `ds:KeyInfo`). В
РЭЦП формата CAdES атрибут `RevocationValues` может также содержать аттестаты,
ссылки на которые указаны в атрибуте `AttributeRevocationReferences`.

### 6.4.5 <a name="Attr45"></a>Атрибут `AttributeCertificateReferences`
<!--- 6.2.3; A.1.3 -->

Неподписанный атрибут `AttributeCertificateReferences` содержит ссылки на
сертификаты, используемые для проверки атрибутных сертификатов и подписанных
утверждений:

а) ДОЛЖЕН содержать ссылки на сертификаты цепочки, включая сертификат точки
доверия, промежуточных УЦ и включая сертификат, использованный для подписи
атрибутного сертификата или утверждения, исключая сертификаты, ссылки на которые
уже содержатся в атрибуте `CompleteCertificateReferences`.

б) МОЖЕТ содержать ссылки на сертификаты цепочек от точки доверия до конечных
сертификатов, не содержащихся в атрибуте `CompleteCertificateReferences` и
использованных для подписи списков отзыва и OCSP-ответов, используемых для
проверки статуса сертификатов, использованных для подписи атрибутных
сертификатов и утверждений.
 
### 6.4.6 <a name="Attr46"></a>Атрибут `AttributeCertificateValues`
<!--- ; XAdES 5.4.3 -->

Неподписанный атрибут `AttributeCertificateValues` содержит сертификаты из
перечня, определенного при описании атрибута `AttributeCertificateReferences`.

### 6.4.7 <a name="Attr47"></a>Атрибут `AttributeRevocationReferences`
<!--- 6.2.4; A.1.4 -->

Неподписанный атрибут `AttributeRevocationReferences` содержит набор ссылок на
аттестаты отзыва сертификатов, ссылки на которые указаны в списках 1 и 2 при
описании атрибута `AttributeCertificateReferences`, включая ссылки на
сертификаты, содержащиеся в `CompleteCertificateReferences`. Ссылки на аттестаты
отзыва, уже содержащиеся в атрибуте `CompleteRevocationReferences`, НЕ ДОЛЖНЫ
включаться в набор.

### 6.4.8 <a name="Attr48"></a>Атрибут `AttributeRevocationValues`
<!--- ; XAdES 5.4.4 -->

Неподписанный атрибут `AttributeRevocationValues` содержит аттестаты отзыва из
перечня, определенного при описании атрибута `AttributeRevocationReferences`.

### 6.4.9 <a name="Attr49"></a>Атрибут `RefsOnlyTimeStamp`
<!--- 6.3.6; A.1.5.1 -->

Неподписанный атрибут `RefsOnlyTimeStamp` содержит штамп времени атрибутов,
содержащих ссылки на аттестаты отзыва.

В РЭЦП формата CAdES разрешается ставить штамп времени на атрибуты
`CompleteCertificateReferences` и `CompleteRevocationReferences`. В РЭЦП формата
XAdES разрешается ставить штамп времени также на атрибуты
`AttributeCertificateReferences` и `AttributeRevocationReferences`.

### 6.4.10 <a name="Attr410"></a>Атрибут `SigAndRefsTimeStamp`
<!--- 6.3.5; A.1.5.2 -->

Неподписанный атрибут `SigAndRefsTimeStamp` содержит штамп времени, покрывающий
следующие объекты:

- значение подписи,
- штампы времени подписи, указанные в атрибуте `SignatureTimeStamp`,
- атрибуты, содержащие ссылки на аттестаты отзыва и перечисленные при описании
атрибута `RefsOnlyTimeStamp`.

## 6.5 <a name="Attr5"></a>Атрибуты архивной проверки

### 6.5.1 <a name="Attr51"></a>Атрибут `TimeStampValidationData`
<!--- ; 5.5.2 -->

<!--- CAdES name - ats-hash-index-v2 -->
Неподписанный атрибут `TimeStampValidationData` содержит данные для проверки
штампов времени, такие как сертификаты и аттестаты отзыва либо их хэш-значения.

### 6.5.2 <a name="Attr52"></a>Атрибут `ArchiveTimeStamp`
<!--- ; 5.5.3 -->

Неподписанный атрибут `ArchiveTimeStamp` содержит штамп времени документа и
РЭЦП, включая подписанные атрибуты и другие существенные компоненты подписи,
защищенные атрибутом `TimeStampValidationData`.

### 6.5.3 <a name="Attr53"></a>Атрибут `RenewedDigests`
<!--- ; XAdES 5.5.3 -->

Неподписанный атрибут `RenewedDigests` содержит хэш-значение от внешних
подписываемых объектов, вычисленное алгоритмом хэширования, отличным от
алгоритма, используемого при указании таких объектов.

Данный атрибут применяется в РЭЦП формата XAdES.

>Примечание — Данный атрибут вычисляется с использованием криптографически
стойких алгоритмов хэширования, когда текущие алгоритмы становятся слабыми.

